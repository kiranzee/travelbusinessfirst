"use strict";
// passenger select
const passengerTrigger = document.getElementById("passengerTrigger");
const passengerInput = document.getElementById("passengerInput");
const closeButton = document.getElementById("closeButton");

passengerTrigger.addEventListener("click", event => {
  event.stopPropagation();
  passengerTrigger.classList.add("d-block");
  passengerTrigger.classList.remove("d-none");
  passengerInput.classList.add("d-block");
  passengerInput.classList.remove("d-none");
});

function closePassengerDetails() {
  passengerInput.classList.add("d-none");
  passengerInput.classList.remove("d-block");
}

closeButton.addEventListener("click", event => {
  event.stopPropagation();
  closePassengerDetails();
});

passengerInput.addEventListener("click", event => {
  event.stopPropagation();
});

document.addEventListener("click", event => {
  if (event.target !== passengerTrigger && !passengerInput.contains(event.target)) {
    closePassengerDetails();
  }
});

$(document).ready(function () {
  $(".content").each(function () {
    if ($(this).height() < $(this)[0].scrollHeight) {
      $(this).parent().find(".txtcol").show();
    }
  });
  $(".txtcol").click(function () {
    if ($(this).prev().hasClass("truncate")) {
      $(this).parent().find(".content").css("max-height", $(this).parent().find(".content")[0].scrollHeight);
      $(this).children("a").text("read less (-)");
    } else {
      $(this).parent().find(".content").css("max-height", "4rem");
      $(this).children("a").text("Read more (+)");
    }
    $(this).prev().toggleClass("truncate");
  });
});

// jQuery slide out modal behavior
$(document).ready(function () {
  $("#onwardTrigger").click(function () {
    $("#onwardModal").fadeIn();
  });
  $("#returnTrigger").click(function () {
    $("#returnModal").fadeIn();
  });

  $(".go-back").click(function () {
    $("#onwardModal").fadeOut();
  });
  $(".go-back").click(function () {
    $("#returnModal").fadeOut();
  });

  $(window).click(function (event) {
    if ($(event.target).is("#onwardModal")) {
      $("#onwardModal").fadeOut();
    }
  });
  $(window).click(function (event) {
    if ($(event.target).is("#returnModal")) {
      $("#returnModal").fadeOut();
    }
  });
});

// Home Carousel script
jQuery(document).ready(function ($) {
  $("#mainCarousel").owlCarousel({
    loop: false,
    nav: false,
    dots: false,
    autoplay: true,
    items: 1,
    autoplayTimeout: 6000,
    smartSpeed: 800,
    autoplayHoverPause: true
  });

  $("#popularCarousel").owlCarousel({
    loop: false,
    margin: 18,
    nav: true,
    dots: false,
    autoplay: true,
    autoplayTimeout: 6000,
    animateOut: "fadeOut",
    animateIn: "fadeIn",
    smartSpeed: 800,
    autoplayHoverPause: true,
    responsive: {
      0: {
        items: 1,
        dots: true,
        nav: false
      },
      600: {
        items: 2
      },
      1000: {
        items: 2.5
      }
    }
  });

  $("#mpfdCarousel").owlCarousel({
    nav: true,
    dots: false,
    autoplayTimeout: 6000,
    animateOut: "fadeOut",
    animateIn: "fadeIn",
    smartSpeed: 800,
    autoplayHoverPause: true,
    responsive: {
      0: {
        items: 1,
        dots: true,
        nav: false
      },
      600: {
        items: 1
      },
      1000: {
        items: 1
      }
    }
  });

  $("#ouruspCarousel").owlCarousel({
    loop: false,
    margin: 18,
    nav: false,
    dots: true,
    autoplay: true,
    autoplayTimeout: 6000,
    animateOut: "fadeOut",
    animateIn: "fadeIn",
    smartSpeed: 800,
    autoplayHoverPause: true,
    responsive: {
      0: {
        items: 1
      },
      600: {
        items: 2
      },
      1000: {
        items: 3
      }
    }
  });

  $("#topthingsCarousel").owlCarousel({
    loop: false,
    margin: 18,
    nav: true,
    dots: false,
    autoplay: true,
    autoplayTimeout: 6000,
    animateOut: "fadeOut",
    animateIn: "fadeIn",
    smartSpeed: 800,
    autoplayHoverPause: true,
    responsive: {
      0: {
        items: 1,
        dots: true,
        nav: false
      },
      600: {
        items: 2
      },
      1000: {
        items: 3
      }
    }
  });

  $("#activityCarousel").owlCarousel({
    loop: false,
    margin: 18,
    nav: true,
    autoplay: true,
    autoplayTimeout: 6000,
    animateOut: "fadeOut",
    animateIn: "fadeIn",
    smartSpeed: 800,
    autoplayHoverPause: true,
    responsive: {
      0: {
        items: 1,
        dots: true,
        nav: false
      },
      600: {
        items: 2
      },
      1000: {
        items: 2.5
      }
    }
  });

  $("#partnerCarousel").owlCarousel({
    loop: false,
    margin: 18,
    nav: false,
    dots: false,
    autoplay: true,
    autoplayTimeout: 6000,
    animateOut: "fadeOut",
    animateIn: "fadeIn",
    smartSpeed: 800,
    autoplayHoverPause: true,
    responsive: {
      0: {
        items: 3
      },
      600: {
        items: 4
      },
      1000: {
        items: 8
      }
    }
  });

  $("#exploreCarousel").owlCarousel({
    loop: false,
    margin: 18,
    nav: true,
    dots: false,
    autoplay: true,
    autoplayTimeout: 6000,
    animateOut: "fadeOut",
    animateIn: "fadeIn",
    smartSpeed: 800,
    autoplayHoverPause: true,
    responsive: {
      0: {
        items: 2,
        dots: true,
        nav: false
      },
      600: {
        items: 2
      },
      1000: {
        items: 4
      }
    }
  });
  $("#attractionCarousel").owlCarousel({
    loop: false,
    margin: 18,
    nav: true,
    dots: false,
    autoplay: true,
    autoplayTimeout: 6000,
    animateOut: "fadeOut",
    animateIn: "fadeIn",
    smartSpeed: 800,
    autoplayHoverPause: true,
    responsive: {
      0: {
        items: 1,
        dots: true,
        nav: false
      },
      600: {
        items: 2
      },
      1000: {
        items: 4
      }
    }
  });

  $("#clientCarousel").owlCarousel({
    autoplay: false,
    autoplayTimeout: 3000,
    autoplayHoverPause: false,
    items: 5,
    center: true,
    nav: false,
    dots: true,
    loop: false,
    responsive: {
      0: {
        items: 1
      },
      991: {
        items: 5
      }
    }
  });

  $("#testimonials").owlCarousel({
    items: 2,
    nav: true,
    margin: 40,
    responsive: {
      0: {
        items: 1,
        dots: true,
        nav: false
      },
      991: {
        dots: false,
        items: 2
      }
    }
  });
});

// multi city flight search
const addBtn = document.getElementById("addBtn");
const container = document.getElementById("mcFlights");
const multiCityContent = document.querySelector(".multi-city").innerHTML;

addBtn.addEventListener("click", () => {
  const newCityDiv = document.createElement("div");
  newCityDiv.classList.add("multi-city");
  newCityDiv.innerHTML = multiCityContent;

  const closeButton = document.createElement("button");
  closeButton.textContent = "x";
  closeButton.classList.add("remove-city");
  newCityDiv.appendChild(closeButton);

  container.appendChild(newCityDiv);

  closeButton.addEventListener("click", () => {
    container.removeChild(newCityDiv);
  });
});

function submitFlightEnquiry() {
  
  var trip = $('#triptype').val();
  var from = $('.fromdest').map(function() { return $(this).val(); }).get();
  var to = $('.todest').map(function() { return $(this).val(); }).get();
  var departureDate = $('.departdate').map(function() { return $(this).val(); }).get();
  //var returnDate = $('.returndate').map(function() { return $(this).val(); }).get();
  var passengers = $('#passengers').text();
  var classType = $('#classtype').text();
  var customerName = $('#cust_name').val();
  var customerEmail = $('#cust_email').val();
  var customerPhone = $('#cust_phone').val();
  var customerComments = $('#cust_comments').val();
  var latestOffers = $('#latestOffer').is(':checked') ? 1 : 0;
  //alert('Hi'+from);
  $.ajax({
      url: '/submit-query',  // Assuming 'submit-query' is your route name
      headers: {
        'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
    },
      method: 'POST',
      data: {
          
          from: from,
          to: to,
          departure_date: departureDate,
         // return_date: '2024-10-21',
          passengers: passengers,
          class_type: classType,
          customer_name: customerName,
          customer_email: customerEmail,
          customer_phone: customerPhone,
          customer_comments: customerComments,
          latest_offers: latestOffers
      },
      success: function(response) {
          alert(response.message);
          window.location.href = '/thank-you';  // Redirect to a thank-you page
      },
      error: function(xhr, status, error) {
          console.log(xhr.responseText);
          alert('An error occurred. Please try again.');
      }
  });
}

function flightEnquiry() {
  alert("clicked");

  return;
  
}
